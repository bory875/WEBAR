(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))n(t);new MutationObserver(t=>{for(const e of t)if(e.type==="childList")for(const i of e.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function s(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?e.credentials="include":t.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function n(t){if(t.ep)return;t.ep=!0;const e=s(t);fetch(t.href,e)}})();let r={video:{facingMode:"user",width:1280,height:720},audio:!1};window.startProcessing=function(){class o{constructor(e,i,a,c){this.cannyTres1=e,this.cannyTres2=i,this.cannyAperture=a,this.FPS=c}onVideoLoaded(e,i,a){this.webcam=e,this.transferCanvId=i,this.displayCanvId=a,this.width=e.videoWidth,this.height=e.videoHeight,console.log(this.width,this.height),this.context=document.getElementById(i).getContext("2d"),this.context.canvas.width=this.width,this.context.canvas.height=this.height,this.rgba1=new cv.Mat(this.height,this.width,cv.CV_8UC4),this.rgba2=new cv.Mat(this.height,this.width,cv.CV_8UC4),this.gray1=new cv.Mat(this.height,this.width,cv.CV_8UC1),this.startProcessing()}startProcessing(){if(this.stopped===!0)return;let e=Date.now();this.context.drawImage(this.webcam,0,0,this.width,this.height),console.log(this.width+" "+this.height),this.rgba1.data.set(this.context.getImageData(0,0,this.width,this.height).data),cv.cvtColor(this.rgba1,this.gray1,cv.COLOR_RGBA2GRAY),cv.Canny(this.gray1,this.gray1,this.cannyTres1,this.cannyTres2,this.cannyAperture,!0),cv.imshow(this.displayCanvId,this.gray1);let i=1e3/this.FPS-(Date.now()-e);setTimeout(this.startProcessing.bind(this),i)}stopProcessing(){this.stopped=!0,this.rgba1.delete(),this.rgba2.delete(),this.gray1.delete()}}const s=new o(150,130,3,30);document.getElementById("switchCamButton").addEventListener("click",()=>{r.video.facingMode==="environment"?r.video.facingMode="user":r.video.facingMode="environment",s.stopProcessing(),s.stopped=!1,s.onVideoLoaded(s.webcam,s.transferCanvId,s.displayCanvId)});let n=document.getElementById("webcam");navigator.mediaDevices.getUserMedia(r).then(function(t){n.srcObject=t,n.play(),n.addEventListener("loadeddata",()=>{s.onVideoLoaded(n,"transferCanvas","displayCanvas")})}).catch(function(t){console.log("An error occurred! "+t)})};
